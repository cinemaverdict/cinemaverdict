<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cinema Verdict</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: black;
    color: white;
}

/* LOGIN */

#loginScreen {
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    gap: 15px;
}

input {
    padding: 10px;
    border-radius: 6px;
    border: none;
    width: 220px;
}

/* HEADER */

.header {
    padding: 15px;
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

/* NAV */

.nav {
    display: flex;
    justify-content: center;
    gap: 15px;
    padding: 10px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.nav button {
    background: transparent;
    color: white;
    border: 1px solid rgba(255,255,255,0.2);
    padding: 6px 14px;
    border-radius: 20px;
    cursor: pointer;
}

/* SEARCH */

.searchBar {
    text-align: center;
    padding: 15px;
}

.searchBar input {
    width: 260px;
}

/* GRID */

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    gap: 15px;
    padding: 20px;
}

.card {
    background: rgba(255,255,255,0.05);
    padding: 10px;
    border-radius: 10px;
    cursor: pointer;
    transition: 0.3s;
}

.card:hover {
    background: rgba(255,255,255,0.12);
}

.card img {
    width: 100%;
    border-radius: 6px;
}

/* FILM VIEW */

#filmView {
    display: none;
    padding: 20px;
}

/* ADMIN */

#adminPanel {
    display: none;
    padding: 20px;
}

textarea {
    width: 100%;
    height: 120px;
}

.button {
    padding: 8px 16px;
    border-radius: 20px;
    border: none;
    cursor: pointer;
}

.primary { background: white; color: black; }

</style>
</head>

<body>

<!-- LOGIN -->

<div id="loginScreen">
    <h2>üîê Cinema Verdict</h2>
    <input id="password" type="password" placeholder="Enter Password">
    <button class="button primary" onclick="login()">Enter</button>
</div>

<!-- MAIN SYSTEM -->

<div id="mainSystem" style="display:none">

    <div class="header">üé¨ Cinema Verdict</div>

    <div class="nav">
        <button onclick="showHome()">Home</button>
        <button onclick="showWatchlist()">Watchlist üíæ</button>
        <button onclick="showAdmin()">Admin üòà</button>
        <button onclick="logout()">Logout</button>
    </div>

    <div class="searchBar">
        <input id="searchInput" placeholder="Search Film‚Ä¶" oninput="renderMovies()">
    </div>

    <div id="homeView" class="grid"></div>

    <!-- FILM VIEW -->

    <div id="filmView">
        <button onclick="showHome()">‚Üê Back</button>
        <h2 id="filmTitle"></h2>
        <img id="filmPoster" width="240">
        <p id="filmRating"></p>
        <p id="filmVerdict"></p>
        <p id="filmReview"></p>
        <button onclick="toggleWatchlist()">üíæ Watchlist</button>
    </div>

    <!-- WATCHLIST -->

    <div id="watchlistView" class="grid" style="display:none"></div>

    <!-- ADMIN -->

    <div id="adminPanel">
        <h3>üòà Admin Panel</h3>
        <input id="movieName" placeholder="Movie Name"><br><br>
        <input id="moviePoster" placeholder="Poster URL"><br><br>
        <input id="movieRating" placeholder="Rating"><br><br>
        <input id="movieVerdict" placeholder="Verdict"><br><br>
        <textarea id="movieReview" placeholder="Review"></textarea><br><br>
        <button class="button primary" onclick="addMovie()">Add Film</button>
    </div>

</div>

<script>

/* CONFIG */

const ADMIN_PASSWORD = "CV_Master_Admin_2026";

/* CSV SOURCE */

const CSV_URL = "https://raw.githubusercontent.com/cinemaverdict/cinemaverdict/refs/heads/main/Cinema%20Verdict%20Studio%2030a48756048f803eb140c9610ede1542.csv";

/* DATA */

let movies = [];

/* FETCH CSV */

fetch(CSV_URL)
.then(res => res.text())
.then(csv => {

    const rows = csv.trim().split("\n").slice(1);

    rows.forEach(row => {

        const cols = row.match(/(".?"|[^",]+)(?=\s,|\s*$)/g);
        if (!cols) return;

        movies.push({
            name: clean(cols[0]),
            poster: clean(cols[1]),
            rating: clean(cols[2]),
            verdict: clean(cols[3]),
            review: clean(cols[4])
        });

    });

});

let currentFilm = null;

/* LOGIN */

function login() {
    if (password.value === ADMIN_PASSWORD) {
        loginScreen.style.display = "none";
        mainSystem.style.display = "block";
        renderMovies();
    } else {
        alert("Wrong Password ‚ùå");
    }
}

function logout() { location.reload(); }

/* VIEW CONTROL */

function showHome() {
    hideAll();
    homeView.style.display = "grid";
    renderMovies();
}

function showFilm(movie) {

    hideAll();
    currentFilm = movie;

    filmView.style.display = "block";

    filmTitle.innerText = movie.name;
    filmPoster.src = movie.poster;
    filmRating.innerText = movie.rating;
    filmVerdict.innerText = movie.verdict;
    filmReview.innerText = movie.review;
}

function showWatchlist() {

    hideAll();
    watchlistView.style.display = "grid";

    const watchlist = JSON.parse(localStorage.getItem("watchlist")) || [];

    watchlistView.innerHTML = "";

    movies.filter(m => watchlist.includes(m.name))
          .forEach(m => createCard(m, watchlistView));
}

function showAdmin() {
    hideAll();
    adminPanel.style.display = "block";
}

function hideAll() {
    homeView.style.display = "none";
    filmView.style.display = "none";
    watchlistView.style.display = "none";
    adminPanel.style.display = "none";
}

/* RENDER */

function renderMovies() {

    const search = searchInput.value.toLowerCase();

    homeView.innerHTML = "";

    movies.filter(m => m.name.toLowerCase().includes(search))
          .forEach(m => createCard(m, homeView));
}

function createCard(movie, container) {

    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
        <img src="${movie.poster}">
        <b>${movie.name}</b>
        <div>${movie.rating}</div>
    `;

    card.onclick = () => showFilm(movie);

    container.appendChild(card);
}

/* WATCHLIST */

function toggleWatchlist() {

    const watchlist = JSON.parse(localStorage.getItem("watchlist")) || [];

    if (watchlist.includes(currentFilm.name)) {
        const updated = watchlist.filter(m => m !== currentFilm.name);
        localStorage.setItem("watchlist", JSON.stringify(updated));
    } else {
        watchlist.push(currentFilm.name);
        localStorage.setItem("watchlist", JSON.stringify(watchlist));
    }

    alert("Updated üíæ");
}

/* ADMIN */

function addMovie() {

    movies.push({
        name: movieName.value,
        poster: moviePoster.value,
        rating: movieRating.value,
        verdict: movieVerdict.value,
        review: movieReview.value
    });

    alert("Film Added (Local Session) ‚úÖ");

    renderMovies();
}

/* HELPERS */

function clean(text) {
    return text ? text.replace(/"/g, '').trim() : '';
}

</script>

</body>
</html>
